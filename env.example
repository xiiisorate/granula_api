# =============================================================================
# Granula API Configuration (Microservices)
# =============================================================================
# Copy this file to .env and update the values

# =============================================================================
# API GATEWAY
# =============================================================================
GATEWAY_ENV=development
GATEWAY_PORT=8080
GATEWAY_HOST=0.0.0.0

# gRPC Service Addresses
AUTH_SERVICE_ADDR=localhost:50051
USER_SERVICE_ADDR=localhost:50052
WORKSPACE_SERVICE_ADDR=localhost:50053
FLOOR_PLAN_SERVICE_ADDR=localhost:50054
SCENE_SERVICE_ADDR=localhost:50055
BRANCH_SERVICE_ADDR=localhost:50056
AI_SERVICE_ADDR=localhost:50057
COMPLIANCE_SERVICE_ADDR=localhost:50058
REQUEST_SERVICE_ADDR=localhost:50059
NOTIFICATION_SERVICE_ADDR=localhost:50060

# =============================================================================
# AUTH SERVICE
# =============================================================================
AUTH_SERVICE_PORT=50051
AUTH_POSTGRES_DSN=postgres://granula:granula_secret@localhost:5432/auth_db?sslmode=disable
AUTH_REDIS_URL=redis://localhost:6379

# JWT
JWT_SECRET=your-256-bit-secret-change-this-in-production
JWT_ACCESS_TTL=15m
JWT_REFRESH_TTL=168h

# OAuth
OAUTH_GOOGLE_CLIENT_ID=
OAUTH_GOOGLE_CLIENT_SECRET=
OAUTH_GOOGLE_REDIRECT_URL=http://localhost:8080/api/v1/auth/oauth/google/callback
OAUTH_YANDEX_CLIENT_ID=
OAUTH_YANDEX_CLIENT_SECRET=
OAUTH_YANDEX_REDIRECT_URL=http://localhost:8080/api/v1/auth/oauth/yandex/callback

# =============================================================================
# USER SERVICE
# =============================================================================
USER_SERVICE_PORT=50052
USER_POSTGRES_DSN=postgres://granula:granula_secret@localhost:5432/users_db?sslmode=disable
USER_S3_ENDPOINT=localhost:9000
USER_S3_ACCESS_KEY=minioadmin
USER_S3_SECRET_KEY=minioadmin
USER_S3_BUCKET=avatars
USER_S3_USE_SSL=false

# =============================================================================
# WORKSPACE SERVICE
# =============================================================================
WORKSPACE_SERVICE_PORT=50053
WORKSPACE_POSTGRES_DSN=postgres://granula:granula_secret@localhost:5432/workspaces_db?sslmode=disable
WORKSPACE_REDIS_URL=redis://localhost:6379

# =============================================================================
# FLOOR PLAN SERVICE
# =============================================================================
FLOOR_PLAN_SERVICE_PORT=50054
FLOOR_PLAN_POSTGRES_DSN=postgres://granula:granula_secret@localhost:5432/floor_plans_db?sslmode=disable
FLOOR_PLAN_S3_ENDPOINT=localhost:9000
FLOOR_PLAN_S3_ACCESS_KEY=minioadmin
FLOOR_PLAN_S3_SECRET_KEY=minioadmin
FLOOR_PLAN_S3_BUCKET=floor-plans
FLOOR_PLAN_S3_USE_SSL=false

# =============================================================================
# SCENE SERVICE
# =============================================================================
SCENE_SERVICE_PORT=50055
SCENE_MONGODB_URI=mongodb://localhost:27017
SCENE_MONGODB_DATABASE=scenes_db

# =============================================================================
# BRANCH SERVICE
# =============================================================================
BRANCH_SERVICE_PORT=50056
BRANCH_MONGODB_URI=mongodb://localhost:27017
BRANCH_MONGODB_DATABASE=branches_db

# =============================================================================
# AI SERVICE
# =============================================================================
AI_SERVICE_PORT=50057
AI_MONGODB_URI=mongodb://localhost:27017
AI_MONGODB_DATABASE=ai_db

# OpenRouter
OPENROUTER_API_KEY=sk-or-v1-your-api-key-here
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1
OPENROUTER_DEFAULT_MODEL=anthropic/claude-sonnet-4
OPENROUTER_VISION_MODEL=anthropic/claude-sonnet-4
OPENROUTER_TIMEOUT=120s
OPENROUTER_MAX_RETRIES=3

# Workers
AI_WORKERS_COUNT=5

# =============================================================================
# COMPLIANCE SERVICE
# =============================================================================
COMPLIANCE_SERVICE_PORT=50058
COMPLIANCE_POSTGRES_DSN=postgres://granula:granula_secret@localhost:5432/compliance_db?sslmode=disable

# =============================================================================
# REQUEST SERVICE
# =============================================================================
REQUEST_SERVICE_PORT=50059
REQUEST_POSTGRES_DSN=postgres://granula:granula_secret@localhost:5432/requests_db?sslmode=disable
REQUEST_REDIS_URL=redis://localhost:6379

# =============================================================================
# NOTIFICATION SERVICE
# =============================================================================
NOTIFICATION_SERVICE_PORT=50060
NOTIFICATION_POSTGRES_DSN=postgres://granula:granula_secret@localhost:5432/notifications_db?sslmode=disable
NOTIFICATION_REDIS_URL=redis://localhost:6379

# SMTP
SMTP_HOST=localhost
SMTP_PORT=1025
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM=Granula <noreply@granula.ru>

# =============================================================================
# SHARED INFRASTRUCTURE
# =============================================================================

# Redis (for Gateway rate limiting, Pub/Sub)
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=
REDIS_DB=0

# =============================================================================
# LOGGING (all services)
# =============================================================================
LOG_LEVEL=debug
LOG_FORMAT=console
LOG_OUTPUT=stdout

# =============================================================================
# RATE LIMITING (Gateway)
# =============================================================================
RATE_LIMIT_GENERAL=1000
RATE_LIMIT_AUTH=10
RATE_LIMIT_AI=20
RATE_LIMIT_UPLOAD=50

# =============================================================================
# CORS (Gateway)
# =============================================================================
CORS_ALLOWED_ORIGINS=*
CORS_MAX_AGE=86400

# =============================================================================
# MONITORING (all services)
# =============================================================================
METRICS_ENABLED=true
METRICS_PATH=/metrics
TRACING_ENABLED=false
TRACING_ENDPOINT=
SENTRY_DSN=

# =============================================================================
# FEATURE FLAGS
# =============================================================================
FEATURE_AI_GENERATION=true
FEATURE_WS_CHAT=true
FEATURE_EXPERT_REQUESTS=true
FEATURE_OAUTH=true
FEATURE_PUSH=false
