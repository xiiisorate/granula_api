syntax = "proto3";

package floor_plan.v1;

option go_package = "github.com/granula/shared/gen/floor_plan/v1;floor_planv1";

import "common/v1/common.proto";

// FloorPlanService - сервис управления планировками
service FloorPlanService {
  // Загрузить планировку
  rpc UploadFloorPlan(UploadFloorPlanRequest) returns (UploadFloorPlanResponse);
  
  // Получить планировку
  rpc GetFloorPlan(GetFloorPlanRequest) returns (GetFloorPlanResponse);
  
  // Список планировок
  rpc ListFloorPlans(ListFloorPlansRequest) returns (ListFloorPlansResponse);
  
  // Удалить планировку
  rpc DeleteFloorPlan(DeleteFloorPlanRequest) returns (DeleteFloorPlanResponse);
  
  // Распознать планировку
  rpc RecognizeFloorPlan(RecognizeFloorPlanRequest) returns (RecognizeFloorPlanResponse);
}

// UploadFloorPlanRequest - запрос загрузки планировки
message UploadFloorPlanRequest {
  string workspace_id = 1;
  bytes image_data = 2;
  string filename = 3;
  string content_type = 4;
}

// UploadFloorPlanResponse - ответ загрузки планировки
message UploadFloorPlanResponse {
  FloorPlan floor_plan = 1;
}

// GetFloorPlanRequest - запрос получения планировки
message GetFloorPlanRequest {
  string floor_plan_id = 1;
}

// GetFloorPlanResponse - ответ получения планировки
message GetFloorPlanResponse {
  FloorPlan floor_plan = 1;
}

// ListFloorPlansRequest - запрос списка планировок
message ListFloorPlansRequest {
  string workspace_id = 1;
  common.v1.Pagination pagination = 2;
}

// ListFloorPlansResponse - ответ списка планировок
message ListFloorPlansResponse {
  repeated FloorPlan floor_plans = 1;
  common.v1.Pagination pagination = 2;
}

// DeleteFloorPlanRequest - запрос удаления планировки
message DeleteFloorPlanRequest {
  string floor_plan_id = 1;
}

// DeleteFloorPlanResponse - ответ удаления планировки
message DeleteFloorPlanResponse {
  bool success = 1;
}

// RecognizeFloorPlanRequest - запрос распознавания планировки
message RecognizeFloorPlanRequest {
  string floor_plan_id = 1;
}

// RecognizeFloorPlanResponse - ответ распознавания планировки
message RecognizeFloorPlanResponse {
  string job_id = 1;
  string status = 2;
}

// FloorPlan - модель планировки
message FloorPlan {
  string id = 1;
  string workspace_id = 2;
  string filename = 3;
  string storage_url = 4;
  string status = 5;
  int64 created_at = 6;
  int64 updated_at = 7;
}

