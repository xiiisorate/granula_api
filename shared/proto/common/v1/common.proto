// =============================================================================
// Common Proto Types
// =============================================================================
// Общие типы данных, используемые всеми микросервисами.
// Version: 1.0.0
// =============================================================================

syntax = "proto3";

package common.v1;

option go_package = "github.com/xiiisorate/granula_api/shared/gen/common/v1;commonv1";

import "google/protobuf/timestamp.proto";

// =============================================================================
// Pagination — пагинация для списков
// =============================================================================

// PaginationRequest — параметры пагинации в запросе.
message PaginationRequest {
  // Номер страницы (начиная с 1). По умолчанию 1.
  int32 page = 1;
  
  // Количество элементов на страницу (1-100). По умолчанию 20.
  int32 page_size = 2;
}

// PaginationResponse — метаданные пагинации в ответе.
message PaginationResponse {
  // Общее количество элементов.
  int32 total = 1;
  
  // Текущая страница.
  int32 page = 2;
  
  // Размер страницы.
  int32 page_size = 3;
  
  // Общее количество страниц.
  int32 total_pages = 4;
  
  // Есть ли следующая страница.
  bool has_next = 5;
  
  // Есть ли предыдущая страница.
  bool has_prev = 6;
}

// =============================================================================
// Common Types — общие типы
// =============================================================================

// Empty — пустое сообщение для методов без параметров или ответа.
message Empty {}

// UUID — обёртка для UUID строки.
message UUID {
  string value = 1;
}

// =============================================================================
// Error Handling — обработка ошибок
// =============================================================================

// Error — стандартная структура ошибки API.
message Error {
  // Код ошибки (например, "VALIDATION_ERROR", "NOT_FOUND").
  string code = 1;
  
  // Человекочитаемое сообщение об ошибке.
  string message = 2;
  
  // Дополнительные детали (например, какие поля невалидны).
  map<string, string> details = 3;
  
  // Уникальный ID ошибки для отладки.
  string trace_id = 4;
}

// ValidationError — ошибка валидации поля.
message ValidationError {
  // Имя поля с ошибкой.
  string field = 1;
  
  // Код ошибки валидации.
  string code = 2;
  
  // Сообщение об ошибке.
  string message = 3;
}

// =============================================================================
// Geometry — геометрические типы для 2D/3D
// =============================================================================

// Point2D — точка в 2D пространстве.
message Point2D {
  // Координата X в метрах.
  double x = 1;
  
  // Координата Y в метрах.
  double y = 2;
}

// Point3D — точка в 3D пространстве.
message Point3D {
  // Координата X в метрах.
  double x = 1;
  
  // Координата Y в метрах.
  double y = 2;
  
  // Координата Z (высота) в метрах.
  double z = 3;
}

// Dimensions2D — размеры в 2D.
message Dimensions2D {
  // Ширина в метрах.
  double width = 1;
  
  // Высота в метрах.
  double height = 2;
}

// Dimensions3D — размеры в 3D.
message Dimensions3D {
  // Ширина в метрах.
  double width = 1;
  
  // Высота в метрах.
  double height = 2;
  
  // Глубина в метрах.
  double depth = 3;
}

// BoundingBox2D — ограничивающий прямоугольник в 2D.
message BoundingBox2D {
  // Минимальная точка (левый нижний угол).
  Point2D min = 1;
  
  // Максимальная точка (правый верхний угол).
  Point2D max = 2;
}

// Polygon2D — полигон из точек (замкнутый контур).
message Polygon2D {
  // Вершины полигона (по часовой стрелке).
  repeated Point2D vertices = 1;
}

// =============================================================================
// Metadata — метаданные сущностей
// =============================================================================

// Timestamps — временные метки создания и обновления.
message Timestamps {
  // Время создания.
  google.protobuf.Timestamp created_at = 1;
  
  // Время последнего обновления.
  google.protobuf.Timestamp updated_at = 2;
}

// AuditInfo — информация об авторстве.
message AuditInfo {
  // ID пользователя, создавшего сущность.
  string created_by = 1;
  
  // ID пользователя, последним обновившего сущность.
  string updated_by = 2;
  
  // Временные метки.
  Timestamps timestamps = 3;
}

// =============================================================================
// Sorting & Filtering — сортировка и фильтрация
// =============================================================================

// SortOrder — направление сортировки.
enum SortOrder {
  SORT_ORDER_UNSPECIFIED = 0;
  SORT_ORDER_ASC = 1;
  SORT_ORDER_DESC = 2;
}

// SortField — поле и направление сортировки.
message SortField {
  // Имя поля для сортировки.
  string field = 1;
  
  // Направление сортировки.
  SortOrder order = 2;
}

