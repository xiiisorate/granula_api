# =============================================================================
# Granula API - OpenAPI 3.0 Specification
# =============================================================================
# –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è REST API –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–º–æ–Ω—Ç–∞ –∏ –ø–µ—Ä–µ–ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∏.
#
# –í–µ—Ä—Å–∏—è: 1.0.0
# –î–∞—Ç–∞: 2024-11-29
# =============================================================================

openapi: 3.0.3

info:
  title: Granula API
  version: 1.0.0
  description: |
    # Granula API

    API –¥–ª—è –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–º–æ–Ω—Ç–∞ –∏ –ø–µ—Ä–µ–ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∏ –∫–≤–∞—Ä—Ç–∏—Ä.

    ## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

    - üè† **–ó–∞–≥—Ä—É–∑–∫–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–æ–∫** - –ó–∞–≥—Ä—É–∂–∞–π—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–ª–∞–Ω–∏—Ä–æ–≤–æ–∫ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
    - ü§ñ **AI —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç, —Å—Ç–µ–Ω –∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    - üé® **3D —Ä–µ–¥–∞–∫—Ç–æ—Ä** - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∏ –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–º 3D —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
    - ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ—Ä–º** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –°–ù–∏–ü –∏ –ñ–ö –†–§
    - üí° **AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—è** - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∏ —Å –ø–æ–º–æ—â—å—é AI
    - üìã **–ó–∞—è–≤–∫–∏ —ç–∫—Å–ø–µ—Ä—Ç–∞–º** - –ü–æ–¥–∞—á–∞ –∑–∞—è–≤–æ–∫ –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –ë–¢–ò

    ## –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

    API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç JWT (JSON Web Tokens) –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

    ### –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤

    1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å —á–µ—Ä–µ–∑ `POST /api/v1/auth/register`
    2. –ò–ª–∏ –≤–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ `POST /api/v1/auth/login`
    3. –ü–æ–ª—É—á–∏—Ç–µ `access_token` –∏ `refresh_token`

    ### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤

    –ü–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ Access Token –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization:
    ```
    Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
    ```

    ### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤

    Access Token –¥–µ–π—Å—Ç–≤—É–µ—Ç 15 –º–∏–Ω—É—Ç. –î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `POST /api/v1/auth/refresh`

    ## Rate Limiting

    | –¢–∏–ø –∑–∞–ø—Ä–æ—Å–∞ | –õ–∏–º–∏—Ç |
    |-------------|-------|
    | –ê–Ω–æ–Ω–∏–º–Ω—ã–µ | 60 req/min |
    | –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ | 300 req/min |
    | AI endpoints | 30 req/min |

    –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è HTTP 429.

    ## –ö–æ–¥—ã –æ—à–∏–±–æ–∫

    | –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
    |-----|----------|
    | VALIDATION_ERROR | –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö |
    | UNAUTHORIZED | –¢—Ä–µ–±—É–µ—Ç—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è |
    | FORBIDDEN | –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ |
    | NOT_FOUND | –†–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω |
    | CONFLICT | –ö–æ–Ω—Ñ–ª–∏–∫—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ) |
    | RATE_LIMITED | –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ |
    | INTERNAL_ERROR | –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ |

    ## –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

    –í—Å–µ endpoints –∏–º–µ—é—Ç –ø—Ä–µ—Ñ–∏–∫—Å `/api/v1/`. –ü—Ä–∏ –≤—ã–ø—É—Å–∫–µ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏–π —Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –º–∏–Ω–∏–º—É–º 6 –º–µ—Å—è—Ü–µ–≤.

  termsOfService: https://granula.ru/terms
  contact:
    name: Granula API Support
    url: https://granula.ru/support
    email: api@granula.ru
  license:
    name: Proprietary
    url: https://granula.ru/license

servers:
  - url: http://localhost:8080/api/v1
    description: –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
  - url: https://api.granula.ru/api/v1
    description: Production —Å–µ—Ä–≤–µ—Ä
  - url: https://staging-api.granula.ru/api/v1
    description: Staging —Å–µ—Ä–≤–µ—Ä

tags:
  - name: auth
    description: |
      ## –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏

      Endpoints –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, –≤—Ö–æ–¥–∞, –≤—ã—Ö–æ–¥–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞–º–∏.
  - name: users
    description: |
      ## –ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

      –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–º, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∏ –∞–≤–∞—Ç–∞—Ä–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
  - name: workspaces
    description: |
      ## –†–∞–±–æ—á–∏–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞

      –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–æ—Ä–∫—Å–ø–µ–π—Å–∞–º–∏ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–∞–º–∏.
  - name: floor-plans
    description: |
      ## –ü–ª–∞–Ω–∏—Ä–æ–≤–∫–∏

      –ó–∞–≥—Ä—É–∑–∫–∞, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∞–º–∏ –∫–≤–∞—Ä—Ç–∏—Ä.
  - name: scenes
    description: |
      ## 3D —Å—Ü–µ–Ω—ã

      –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 3D —Å—Ü–µ–Ω–∞–º–∏ –∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ (—Å—Ç–µ–Ω—ã, –∫–æ–º–Ω–∞—Ç—ã, –º–µ–±–µ–ª—å).
  - name: branches
    description: |
      ## –í–µ—Ç–∫–∏ –¥–∏–∑–∞–π–Ω–∞

      –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∏.
  - name: ai
    description: |
      ## AI —Å–µ—Ä–≤–∏—Å—ã

      –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–æ–∫, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏ AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç.
  - name: compliance
    description: |
      ## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è

      –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –°–ù–∏–ü –∏ –ñ–ö –†–§.
  - name: requests
    description: |
      ## –ó–∞—è–≤–∫–∏ —ç–∫—Å–ø–µ—Ä—Ç–∞–º

      –ü–æ–¥–∞—á–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏ –Ω–∞ —É—Å–ª—É–≥–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –ë–¢–ò.
  - name: notifications
    description: |
      ## –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

      –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ —Å–æ–±—ã—Ç–∏—è—Ö –≤ —Å–∏—Å—Ç–µ–º–µ.

# =============================================================================
# Security Schemes
# =============================================================================
components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: |
        JWT —Ç–æ–∫–µ–Ω –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –ü–æ–ª—É—á–∏—Ç–µ —á–µ—Ä–µ–∑ `/auth/login` –∏–ª–∏ `/auth/register`.

        –§–æ—Ä–º–∞—Ç: `Bearer <token>`

  # ===========================================================================
  # Schemas
  # ===========================================================================
  schemas:
    # -------------------------------------------------------------------------
    # Error Responses
    # -------------------------------------------------------------------------
    Error:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: –ú–∞—à–∏–Ω–æ—á–∏—Ç–∞–µ–º—ã–π –∫–æ–¥ –æ—à–∏–±–∫–∏
          example: VALIDATION_ERROR
        message:
          type: string
          description: –ß–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏
          example: –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email
        details:
          type: object
          additionalProperties:
            type: string
          description: –î–µ—Ç–∞–ª–∏ –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–æ –ø–æ–ª—è–º
          example:
            email: "–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email"
            password: "–ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤"
        request_id:
          type: string
          description: ID –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
          example: req-abc123def456

    ValidationError:
      allOf:
        - $ref: "#/components/schemas/Error"
        - type: object
          properties:
            code:
              example: VALIDATION_ERROR

    # -------------------------------------------------------------------------
    # Pagination
    # -------------------------------------------------------------------------
    Pagination:
      type: object
      properties:
        total:
          type: integer
          description: –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
          example: 150
        page:
          type: integer
          description: –¢–µ–∫—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
          example: 1
        page_size:
          type: integer
          description: –≠–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
          example: 20
        total_pages:
          type: integer
          description: –í—Å–µ–≥–æ —Å—Ç—Ä–∞–Ω–∏—Ü
          example: 8
        has_next:
          type: boolean
          description: –ï—Å—Ç—å —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
          example: true
        has_prev:
          type: boolean
          description: –ï—Å—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
          example: false

    # -------------------------------------------------------------------------
    # Auth Schemas
    # -------------------------------------------------------------------------
    RegisterRequest:
      type: object
      required:
        - email
        - password
        - name
      properties:
        email:
          type: string
          format: email
          maxLength: 255
          description: Email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π)
          example: user@example.com
        password:
          type: string
          format: password
          minLength: 8
          maxLength: 72
          description: –ü–∞—Ä–æ–ª—å (–º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã –∏ —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã)
          example: SecurePass123!
        name:
          type: string
          minLength: 2
          maxLength: 255
          description: –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
          example: –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤

    LoginRequest:
      type: object
      required:
        - email
        - password
      properties:
        email:
          type: string
          format: email
          description: Email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
          example: user@example.com
        password:
          type: string
          format: password
          description: –ü–∞—Ä–æ–ª—å
          example: SecurePass123!
        device_id:
          type: string
          description: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏—è–º–∏
          example: device-123-abc

    AuthTokens:
      type: object
      properties:
        user_id:
          type: string
          format: uuid
          description: UUID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
          example: 550e8400-e29b-41d4-a716-446655440000
        access_token:
          type: string
          description: JWT Access Token (–≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ 15 –º–∏–Ω—É—Ç)
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        refresh_token:
          type: string
          description: Refresh Token –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è Access Token
          example: dGhpcyBpcyBhIHJlZnJlc2ggdG9rZW4...
        expires_at:
          type: integer
          format: int64
          description: Unix timestamp –∏—Å—Ç–µ—á–µ–Ω–∏—è Access Token
          example: 1701234567
        token_type:
          type: string
          description: –¢–∏–ø —Ç–æ–∫–µ–Ω–∞
          example: Bearer
          enum: [Bearer]

    RefreshRequest:
      type: object
      required:
        - refresh_token
      properties:
        refresh_token:
          type: string
          description: Refresh Token
          example: dGhpcyBpcyBhIHJlZnJlc2ggdG9rZW4...

    # -------------------------------------------------------------------------
    # User Schemas
    # -------------------------------------------------------------------------
    User:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: UUID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
          example: 550e8400-e29b-41d4-a716-446655440000
        email:
          type: string
          format: email
          description: Email
          example: user@example.com
        name:
          type: string
          description: –ò–º—è
          example: –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤
        avatar_url:
          type: string
          format: uri
          description: URL –∞–≤–∞—Ç–∞—Ä–∞
          example: https://storage.granula.ru/avatars/user-123.jpg
        phone:
          type: string
          description: –¢–µ–ª–µ—Ñ–æ–Ω
          example: "+7 (999) 123-45-67"
        created_at:
          type: string
          format: date-time
          description: –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
          example: "2024-01-15T10:30:00Z"
        updated_at:
          type: string
          format: date-time
          description: –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
          example: "2024-11-29T14:20:00Z"

    UpdateUserRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 2
          maxLength: 255
          description: –ù–æ–≤–æ–µ –∏–º—è
          example: –ò–≤–∞–Ω –°–∏–¥–æ—Ä–æ–≤
        phone:
          type: string
          description: –ù–æ–≤—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω
          example: "+79991234567"

    # -------------------------------------------------------------------------
    # Workspace Schemas
    # -------------------------------------------------------------------------
    Workspace:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: UUID –≤–æ—Ä–∫—Å–ø–µ–π—Å–∞
          example: 550e8400-e29b-41d4-a716-446655440000
        owner_id:
          type: string
          format: uuid
          description: UUID –≤–ª–∞–¥–µ–ª—å—Ü–∞
          example: 660e8400-e29b-41d4-a716-446655440001
        name:
          type: string
          description: –ù–∞–∑–≤–∞–Ω–∏–µ
          example: –ü–µ—Ä–µ–ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∞ –∫–≤–∞—Ä—Ç–∏—Ä—ã –Ω–∞ –¢–≤–µ—Ä—Å–∫–æ–π
        description:
          type: string
          description: –û–ø–∏—Å–∞–Ω–∏–µ
          example: –ü—Ä–æ–µ–∫—Ç –ø–µ—Ä–µ–ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∏ 3-–∫–æ–º–Ω–∞—Ç–Ω–æ–π –∫–≤–∞—Ä—Ç–∏—Ä—ã
        member_count:
          type: integer
          description: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
          example: 3
        project_count:
          type: integer
          description: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–µ–∫—Ç–æ–≤
          example: 2
        created_at:
          type: string
          format: date-time
          example: "2024-01-15T10:30:00Z"
        updated_at:
          type: string
          format: date-time
          example: "2024-11-29T14:20:00Z"
        members:
          type: array
          items:
            $ref: "#/components/schemas/Member"

    CreateWorkspaceRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          minLength: 2
          maxLength: 100
          description: –ù–∞–∑–≤–∞–Ω–∏–µ –≤–æ—Ä–∫—Å–ø–µ–π—Å–∞
          example: –ü–µ—Ä–µ–ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∞ –∫–≤–∞—Ä—Ç–∏—Ä—ã
        description:
          type: string
          maxLength: 1000
          description: –û–ø–∏—Å–∞–Ω–∏–µ
          example: –ü—Ä–æ–µ–∫—Ç –ø–µ—Ä–µ–ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∏ 3-–∫–æ–º–Ω–∞—Ç–Ω–æ–π –∫–≤–∞—Ä—Ç–∏—Ä—ã

    Member:
      type: object
      properties:
        id:
          type: string
          format: uuid
          example: 770e8400-e29b-41d4-a716-446655440002
        user_id:
          type: string
          format: uuid
          example: 880e8400-e29b-41d4-a716-446655440003
        role:
          type: string
          enum: [owner, admin, editor, viewer]
          description: |
            –†–æ–ª—å —É—á–∞—Å—Ç–Ω–∏–∫–∞:
            - **owner** - –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å, –º–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å –≤–æ—Ä–∫—Å–ø–µ–π—Å
            - **admin** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
            - **editor** - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            - **viewer** - –¢–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä
          example: editor
        joined_at:
          type: string
          format: date-time
          example: "2024-02-20T12:00:00Z"

    AddMemberRequest:
      type: object
      required:
        - user_id
        - role
      properties:
        user_id:
          type: string
          format: uuid
          description: UUID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
          example: 880e8400-e29b-41d4-a716-446655440003
        role:
          type: string
          enum: [admin, editor, viewer]
          description: –†–æ–ª—å (owner –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
          example: editor

    # -------------------------------------------------------------------------
    # Floor Plan Schemas
    # -------------------------------------------------------------------------
    FloorPlan:
      type: object
      properties:
        id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
        workspace_id:
          type: string
          format: uuid
          example: 660e8400-e29b-41d4-a716-446655440001
        name:
          type: string
          example: –ü–ª–∞–Ω –∫–≤–∞—Ä—Ç–∏—Ä—ã - —ç—Ç–∞–∂ 2
        description:
          type: string
          example: –ü–ª–∞–Ω –≤—Ç–æ—Ä–æ–≥–æ —ç—Ç–∞–∂–∞
        address:
          type: string
          example: –≥. –ú–æ—Å–∫–≤–∞, —É–ª. –¢–≤–µ—Ä—Å–∫–∞—è, –¥. 15
        status:
          type: string
          enum: [uploaded, processing, recognized, failed]
          description: |
            –°—Ç–∞—Ç—É—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏:
            - **uploaded** - –ó–∞–≥—Ä—É–∂–µ–Ω, –æ–∂–∏–¥–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏
            - **processing** - –ò–¥–µ—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ
            - **recognized** - –£—Å–ø–µ—à–Ω–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω
            - **failed** - –û—à–∏–±–∫–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
          example: recognized
        image_url:
          type: string
          format: uri
          example: https://storage.granula.ru/floorplans/fp-123.jpg
        thumbnail_url:
          type: string
          format: uri
          example: https://storage.granula.ru/thumbnails/fp-123-thumb.jpg
        recognition_result:
          $ref: "#/components/schemas/RecognitionResult"
        scene_id:
          type: string
          format: uuid
          description: ID —Å–≤—è–∑–∞–Ω–Ω–æ–π 3D —Å—Ü–µ–Ω—ã
          example: 770e8400-e29b-41d4-a716-446655440002
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    RecognitionResult:
      type: object
      properties:
        rooms_count:
          type: integer
          description: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã—Ö –∫–æ–º–Ω–∞—Ç
          example: 4
        total_area:
          type: number
          format: float
          description: –û–±—â–∞—è –ø–ª–æ—â–∞–¥—å (–∫–≤.–º)
          example: 78.5
        living_area:
          type: number
          format: float
          description: –ñ–∏–ª–∞—è –ø–ª–æ—â–∞–¥—å (–∫–≤.–º)
          example: 52.3
        rooms:
          type: array
          items:
            $ref: "#/components/schemas/RecognizedRoom"
        confidence:
          type: number
          format: float
          description: –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è (0-1)
          example: 0.94
        processing_time_ms:
          type: integer
          description: –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–º—Å)
          example: 1250

    RecognizedRoom:
      type: object
      properties:
        type:
          type: string
          enum:
            [
              living_room,
              bedroom,
              kitchen,
              bathroom,
              toilet,
              hallway,
              balcony,
              storage,
              other,
            ]
          example: bedroom
        name:
          type: string
          example: –°–ø–∞–ª—å–Ω—è 1
        area:
          type: number
          format: float
          example: 18.5
        polygon:
          type: array
          items:
            $ref: "#/components/schemas/Point2D"

    Point2D:
      type: object
      properties:
        x:
          type: number
          format: float
          example: 120.5
        y:
          type: number
          format: float
          example: 80.3

    # -------------------------------------------------------------------------
    # Scene Schemas
    # -------------------------------------------------------------------------
    Scene:
      type: object
      properties:
        id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
        workspace_id:
          type: string
          format: uuid
        floor_plan_id:
          type: string
          format: uuid
        name:
          type: string
          example: –°—Ü–µ–Ω–∞ –∫–≤–∞—Ä—Ç–∏—Ä—ã - –≤–∞—Ä–∏–∞–Ω—Ç 1
        description:
          type: string
        status:
          type: string
          enum: [draft, active, archived]
          example: active
        element_count:
          type: integer
          example: 42
        branch_count:
          type: integer
          example: 3
        statistics:
          $ref: "#/components/schemas/SceneStatistics"
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    SceneStatistics:
      type: object
      properties:
        walls_count:
          type: integer
          example: 15
        rooms_count:
          type: integer
          example: 4
        windows_count:
          type: integer
          example: 6
        doors_count:
          type: integer
          example: 5
        furniture_count:
          type: integer
          example: 12
        total_area:
          type: number
          format: float
          example: 78.5
        living_area:
          type: number
          format: float
          example: 52.3

    Element:
      type: object
      properties:
        id:
          type: string
          format: uuid
        scene_id:
          type: string
          format: uuid
        type:
          type: string
          enum: [wall, room, door, window, furniture, fixture]
          example: wall
        name:
          type: string
          example: –ù–µ—Å—É—â–∞—è —Å—Ç–µ–Ω–∞ –∫—É—Ö–Ω—è-–≥–æ—Å—Ç–∏–Ω–∞—è
        position:
          $ref: "#/components/schemas/Point3D"
        dimensions:
          $ref: "#/components/schemas/Dimensions3D"
        rotation:
          $ref: "#/components/schemas/Rotation"
        properties:
          type: object
          additionalProperties: true
        is_load_bearing:
          type: boolean
          example: true
        created_at:
          type: string
          format: date-time

    Point3D:
      type: object
      properties:
        x:
          type: number
          format: float
          example: 5.0
        y:
          type: number
          format: float
          example: 2.5
        z:
          type: number
          format: float
          example: 0.0

    Dimensions3D:
      type: object
      properties:
        width:
          type: number
          format: float
          example: 3.5
        height:
          type: number
          format: float
          example: 2.8
        depth:
          type: number
          format: float
          example: 0.2

    Rotation:
      type: object
      properties:
        x:
          type: number
          format: float
          example: 0.0
        y:
          type: number
          format: float
          example: 45.0
        z:
          type: number
          format: float
          example: 0.0

    # -------------------------------------------------------------------------
    # Branch Schemas
    # -------------------------------------------------------------------------
    Branch:
      type: object
      properties:
        id:
          type: string
          format: uuid
        scene_id:
          type: string
          format: uuid
        parent_branch_id:
          type: string
          format: uuid
        name:
          type: string
          example: –í–∞—Ä–∏–∞–Ω—Ç —Å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–æ–π –∫—É—Ö–Ω–µ–π
        description:
          type: string
        status:
          type: string
          enum: [active, archived, merged]
          example: active
        is_main:
          type: boolean
          example: false
        created_by:
          type: string
          format: uuid
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    CreateBranchRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          minLength: 2
          maxLength: 255
          example: –í–∞—Ä–∏–∞–Ω—Ç 2 - —Å—Ç—É–¥–∏—è
        description:
          type: string
          maxLength: 1000
        parent_branch_id:
          type: string
          format: uuid

    # -------------------------------------------------------------------------
    # Compliance Schemas
    # -------------------------------------------------------------------------
    ComplianceCheckRequest:
      type: object
      required:
        - scene_id
      properties:
        scene_id:
          type: string
          format: uuid
          description: ID —Å—Ü–µ–Ω—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
        branch_id:
          type: string
          format: uuid
          description: ID –≤–µ—Ç–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
        categories:
          type: array
          items:
            type: string
          description: –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–∞–≤–∏–ª –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
          example: [minimum_area, ventilation]
        operation_type:
          type: string
          enum: [construction, renovation, redevelopment]
          example: redevelopment

    ComplianceCheckResponse:
      type: object
      properties:
        check_id:
          type: string
          format: uuid
        scene_id:
          type: string
          format: uuid
        status:
          type: string
          enum: [passed, warning, failed]
          description: |
            –û–±—â–∏–π —Å—Ç–∞—Ç—É—Å:
            - **passed** - –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã
            - **warning** - –ï—Å—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
            - **failed** - –ï—Å—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è
          example: warning
        score:
          type: integer
          description: –û–±—â–∏–π –±–∞–ª–ª —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è (0-100)
          example: 78
        violation_count:
          type: integer
          example: 2
        warning_count:
          type: integer
          example: 3
        violations:
          type: array
          items:
            $ref: "#/components/schemas/Violation"
        category_stats:
          type: array
          items:
            $ref: "#/components/schemas/CategoryStat"
        checked_at:
          type: string
          format: date-time
        processing_time_ms:
          type: integer
          example: 320

    Violation:
      type: object
      properties:
        id:
          type: string
          format: uuid
        rule_id:
          type: string
          example: SNIP-MIN-AREA-01
        rule_name:
          type: string
          example: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø–ª–æ—â–∞–¥—å –∂–∏–ª–æ–π –∫–æ–º–Ω–∞—Ç—ã
        category:
          type: string
          example: minimum_area
        severity:
          type: string
          enum: [error, warning, info]
          description: |
            –°–µ—Ä—å–µ–∑–Ω–æ—Å—Ç—å:
            - **error** - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞—Ä—É—à–µ–Ω–∏–µ, –±–ª–æ–∫–∏—Ä—É–µ—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ
            - **warning** - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø—Ä–∞–≤–∏—Ç—å
            - **info** - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
          example: error
        description:
          type: string
          example: –ü–ª–æ—â–∞–¥—å —Å–ø–∞–ª—å–Ω–∏ (7.5 –∫–≤.–º) –º–µ–Ω—å—à–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –¥–æ–ø—É—Å—Ç–∏–º–æ–π (8 –∫–≤.–º)
        affected_elements:
          type: array
          items:
            type: object
            properties:
              element_id:
                type: string
                format: uuid
              element_type:
                type: string
              element_name:
                type: string
        recommendations:
          type: array
          items:
            type: string
          example:
            - –£–≤–µ–ª–∏—á–∏—Ç—å –ø–ª–æ—â–∞–¥—å –∫–æ–º–Ω–∞—Ç—ã –º–∏–Ω–∏–º—É–º –Ω–∞ 0.5 –∫–≤.–º
            - –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —Å–æ—Å–µ–¥–Ω–µ–π –∫–æ–º–Ω–∞—Ç–æ–π
        legal_reference:
          type: string
          example: –°–ù–∏–ü 31-01-2003, –ø. 5.3

    CategoryStat:
      type: object
      properties:
        category:
          type: string
          example: minimum_area
        category_name:
          type: string
          example: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø–ª–æ—â–∞–¥–∏
        total_rules:
          type: integer
          example: 8
        passed:
          type: integer
          example: 6
        violations:
          type: integer
          example: 1
        warnings:
          type: integer
          example: 1

    ComplianceRule:
      type: object
      properties:
        id:
          type: string
          example: SNIP-MIN-AREA-01
        name:
          type: string
          example: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø–ª–æ—â–∞–¥—å –∂–∏–ª–æ–π –∫–æ–º–Ω–∞—Ç—ã
        category:
          type: string
          example: minimum_area
        description:
          type: string
          example: –ü–ª–æ—â–∞–¥—å –∂–∏–ª–æ–π –∫–æ–º–Ω–∞—Ç—ã –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 8 –∫–≤.–º
        default_severity:
          type: string
          enum: [error, warning, info]
          example: error
        legal_reference:
          type: string
          example: –°–ù–∏–ü 31-01-2003
        applicable_operations:
          type: array
          items:
            type: string
          example: [construction, redevelopment]
        is_active:
          type: boolean
          example: true

    # -------------------------------------------------------------------------
    # Request (Expert) Schemas
    # -------------------------------------------------------------------------
    ExpertRequest:
      type: object
      properties:
        id:
          type: string
          format: uuid
        workspace_id:
          type: string
          format: uuid
        user_id:
          type: string
          format: uuid
        title:
          type: string
          example: –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è –ø–æ –ø–µ—Ä–µ–ø–ª–∞–Ω–∏—Ä–æ–≤–∫–µ
        description:
          type: string
        category:
          type: string
          enum: [consultation, documentation, expert_visit, full_package]
          description: |
            –ö–∞—Ç–µ–≥–æ—Ä–∏—è —É—Å–ª—É–≥–∏:
            - **consultation** - –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è (2000‚ÇΩ)
            - **documentation** - –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ (15000‚ÇΩ)
            - **expert_visit** - –í—ã–µ–∑–¥ —ç–∫—Å–ø–µ—Ä—Ç–∞ (5000‚ÇΩ)
            - **full_package** - –ü–æ–ª–Ω—ã–π –ø–∞–∫–µ—Ç (30000‚ÇΩ)
        priority:
          type: string
          enum: [low, normal, high, urgent]
          example: normal
        status:
          type: string
          enum:
            [
              draft,
              pending,
              in_review,
              approved,
              rejected,
              assigned,
              in_progress,
              completed,
              cancelled,
            ]
          description: |
            –°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏:
            - **draft** - –ß–µ—Ä–Ω–æ–≤–∏–∫
            - **pending** - –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ
            - **in_review** - –ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏
            - **approved** - –û–¥–æ–±—Ä–µ–Ω–∞
            - **rejected** - –û—Ç–∫–ª–æ–Ω–µ–Ω–∞
            - **assigned** - –ù–∞–∑–Ω–∞—á–µ–Ω —ç–∫—Å–ø–µ—Ä—Ç
            - **in_progress** - –í —Ä–∞–±–æ—Ç–µ
            - **completed** - –ó–∞–≤–µ—Ä—à–µ–Ω–∞
            - **cancelled** - –û—Ç–º–µ–Ω–µ–Ω–∞
          example: pending
        expert_id:
          type: string
          format: uuid
        assigned_at:
          type: string
          format: date-time
        estimated_cost:
          type: integer
          description: –û—Ü–µ–Ω–æ—á–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å (—Ä—É–±–ª–∏)
          example: 2000
        final_cost:
          type: integer
          description: –§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å (—Ä—É–±–ª–∏)
        rejection_reason:
          type: string
        contact_phone:
          type: string
          example: "+79991234567"
        contact_email:
          type: string
          format: email
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        completed_at:
          type: string
          format: date-time

    CreateExpertRequestRequest:
      type: object
      required:
        - workspace_id
        - title
        - description
        - category
      properties:
        workspace_id:
          type: string
          format: uuid
        title:
          type: string
          minLength: 5
          maxLength: 200
          example: –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è –ø–æ –ø–µ—Ä–µ–ø–ª–∞–Ω–∏—Ä–æ–≤–∫–µ 3-–∫–æ–º–Ω–∞—Ç–Ω–æ–π –∫–≤–∞—Ä—Ç–∏—Ä—ã
        description:
          type: string
          minLength: 10
          maxLength: 5000
        category:
          type: string
          enum: [consultation, documentation, expert_visit, full_package]
        priority:
          type: string
          enum: [low, normal, high, urgent]
          default: normal
        contact_phone:
          type: string
        contact_email:
          type: string
          format: email

    # -------------------------------------------------------------------------
    # AI Schemas
    # -------------------------------------------------------------------------
    ChatMessageRequest:
      type: object
      required:
        - message
      properties:
        session_id:
          type: string
          format: uuid
          description: ID —Å–µ—Å—Å–∏–∏ (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
        message:
          type: string
          minLength: 1
          maxLength: 4000
          example: –ö–∞–∫ –ª—É—á—à–µ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –≤ –∫–≤–∞—Ä—Ç–∏—Ä–µ 50 –∫–≤.–º?
        scene_id:
          type: string
          format: uuid
          description: ID —Å—Ü–µ–Ω—ã –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

    ChatMessageResponse:
      type: object
      properties:
        session_id:
          type: string
          format: uuid
        message_id:
          type: string
          format: uuid
        response:
          type: string
          example: –î–ª—è –∫–≤–∞—Ä—Ç–∏—Ä—ã 50 –∫–≤.–º —Ä–µ–∫–æ–º–µ–Ω–¥—É—é...
        suggestions:
          type: array
          items:
            $ref: "#/components/schemas/AISuggestion"
        tokens_used:
          type: integer
          example: 450
        created_at:
          type: string
          format: date-time

    AISuggestion:
      type: object
      properties:
        type:
          type: string
          enum:
            [
              layout_change,
              furniture_placement,
              space_optimization,
              compliance_warning,
            ]
        title:
          type: string
          example: –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∫—É—Ö–Ω–∏ –∏ –≥–æ—Å—Ç–∏–Ω–æ–π
        description:
          type: string
        confidence:
          type: number
          format: float
          example: 0.87

    GenerateVariantsRequest:
      type: object
      required:
        - scene_id
        - count
      properties:
        scene_id:
          type: string
          format: uuid
        count:
          type: integer
          minimum: 1
          maximum: 5
          example: 3
        style:
          type: string
          enum: [modern, classic, minimalist, scandinavian, loft]
          example: modern
        priorities:
          type: array
          items:
            type: string
          example: [maximize_light, open_space]
        keep_elements:
          type: array
          items:
            type: string
            format: uuid
          description: ID —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–ª—å–∑—è –∏–∑–º–µ–Ω—è—Ç—å
        budget_range:
          type: object
          properties:
            min:
              type: integer
              example: 100000
            max:
              type: integer
              example: 500000

    GenerateVariantsResponse:
      type: object
      properties:
        task_id:
          type: string
          format: uuid
        status:
          type: string
          enum: [processing, completed, failed]
        variants:
          type: array
          items:
            $ref: "#/components/schemas/GeneratedVariant"
        processing_time_ms:
          type: integer
        error:
          type: string

    GeneratedVariant:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
          example: –í–∞—Ä–∏–∞–Ω—Ç 1 - –û—Ç–∫—Ä—ã—Ç–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ
        description:
          type: string
        branch_id:
          type: string
          format: uuid
        quality_score:
          type: integer
          description: –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ (0-100)
          example: 85
        estimated_cost:
          type: integer
          description: –û—Ü–µ–Ω–æ—á–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
          example: 350000
        preview_url:
          type: string
          format: uri
        changes:
          type: array
          items:
            type: object
            properties:
              type:
                type: string
              description:
                type: string
              affected_elements:
                type: array
                items:
                  type: string

    # -------------------------------------------------------------------------
    # Common Schemas
    # -------------------------------------------------------------------------
    SuccessResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: Operation completed successfully

# =============================================================================
# Paths
# =============================================================================
paths:
  # ---------------------------------------------------------------------------
  # Auth Endpoints
  # ---------------------------------------------------------------------------
  /auth/register:
    post:
      tags: [auth]
      summary: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      description: –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–∫–µ–Ω—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
      operationId: register
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RegisterRequest"
      responses:
        "201":
          description: –£—Å–ø–µ—à–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthTokens"
        "400":
          description: –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ValidationError"
        "409":
          description: Email —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /auth/login:
    post:
      tags: [auth]
      summary: –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
      description: –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ email –∏ –ø–∞—Ä–æ–ª—é
      operationId: login
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/LoginRequest"
      responses:
        "200":
          description: –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthTokens"
        "401":
          description: –ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /auth/refresh:
    post:
      tags: [auth]
      summary: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
      description: –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ –ø–æ refresh token
      operationId: refreshTokens
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RefreshRequest"
      responses:
        "200":
          description: –¢–æ–∫–µ–Ω—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthTokens"
        "401":
          description: –ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π refresh token
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /auth/logout:
    post:
      tags: [auth]
      summary: –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
      description: –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è refresh token
      operationId: logout
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RefreshRequest"
      responses:
        "200":
          description: –£—Å–ø–µ—à–Ω—ã–π –≤—ã—Ö–æ–¥
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"

  # ---------------------------------------------------------------------------
  # User Endpoints
  # ---------------------------------------------------------------------------
  /users/me:
    get:
      tags: [users]
      summary: –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
      description: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      operationId: getProfile
      security:
        - BearerAuth: []
      responses:
        "200":
          description: –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        "401":
          description: –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    patch:
      tags: [users]
      summary: –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
      description: –û–±–Ω–æ–≤–ª—è–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      operationId: updateProfile
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateUserRequest"
      responses:
        "200":
          description: –ü—Ä–æ—Ñ–∏–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"

  # ---------------------------------------------------------------------------
  # Workspace Endpoints
  # ---------------------------------------------------------------------------
  /workspaces:
    get:
      tags: [workspaces]
      summary: –°–ø–∏—Å–æ–∫ –≤–æ—Ä–∫—Å–ø–µ–π—Å–æ–≤
      description: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤–æ—Ä–∫—Å–ø–µ–π—Å–æ–≤ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      operationId: listWorkspaces
      security:
        - BearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: page_size
          in: query
          schema:
            type: integer
            default: 20
            minimum: 1
            maximum: 100
        - name: name
          in: query
          description: –§–∏–ª—å—Ç—Ä –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é
          schema:
            type: string
      responses:
        "200":
          description: –°–ø–∏—Å–æ–∫ –≤–æ—Ä–∫—Å–ø–µ–π—Å–æ–≤
          content:
            application/json:
              schema:
                type: object
                properties:
                  workspaces:
                    type: array
                    items:
                      $ref: "#/components/schemas/Workspace"
                  pagination:
                    $ref: "#/components/schemas/Pagination"
    post:
      tags: [workspaces]
      summary: –°–æ–∑–¥–∞—Ç—å –≤–æ—Ä–∫—Å–ø–µ–π—Å
      operationId: createWorkspace
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateWorkspaceRequest"
      responses:
        "201":
          description: –í–æ—Ä–∫—Å–ø–µ–π—Å —Å–æ–∑–¥–∞–Ω
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Workspace"

  /workspaces/{id}:
    get:
      tags: [workspaces]
      summary: –ü–æ–ª—É—á–∏—Ç—å –≤–æ—Ä–∫—Å–ø–µ–π—Å
      operationId: getWorkspace
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: –î–∞–Ω–Ω—ã–µ –≤–æ—Ä–∫—Å–ø–µ–π—Å–∞
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Workspace"
        "404":
          description: –ù–µ –Ω–∞–π–¥–µ–Ω
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    patch:
      tags: [workspaces]
      summary: –û–±–Ω–æ–≤–∏—Ç—å –≤–æ—Ä–∫—Å–ø–µ–π—Å
      operationId: updateWorkspace
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateWorkspaceRequest"
      responses:
        "200":
          description: –í–æ—Ä–∫—Å–ø–µ–π—Å –æ–±–Ω–æ–≤–ª–µ–Ω
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Workspace"
    delete:
      tags: [workspaces]
      summary: –£–¥–∞–ª–∏—Ç—å –≤–æ—Ä–∫—Å–ø–µ–π—Å
      description: –£–¥–∞–ª—è–µ—Ç –≤–æ—Ä–∫—Å–ø–µ–π—Å (—Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü)
      operationId: deleteWorkspace
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: –í–æ—Ä–∫—Å–ø–µ–π—Å —É–¥–∞–ª–µ–Ω
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"

  /workspaces/{id}/members:
    get:
      tags: [workspaces]
      summary: –°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
      operationId: getWorkspaceMembers
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: –°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Member"
    post:
      tags: [workspaces]
      summary: –î–æ–±–∞–≤–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∞
      operationId: addWorkspaceMember
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AddMemberRequest"
      responses:
        "201":
          description: –£—á–∞—Å—Ç–Ω–∏–∫ –¥–æ–±–∞–≤–ª–µ–Ω
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Member"

  # ---------------------------------------------------------------------------
  # Floor Plan Endpoints
  # ---------------------------------------------------------------------------
  /floor-plans:
    post:
      tags: [floor-plans]
      summary: –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–ª–∞–Ω–∏—Ä–æ–≤–∫—É
      operationId: uploadFloorPlan
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - workspace_id
                - name
                - file
              properties:
                workspace_id:
                  type: string
                  format: uuid
                name:
                  type: string
                description:
                  type: string
                address:
                  type: string
                file:
                  type: string
                  format: binary
      responses:
        "201":
          description: –ü–ª–∞–Ω–∏—Ä–æ–≤–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FloorPlan"

  /floor-plans/{id}/process:
    post:
      tags: [floor-plans]
      summary: –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ
      operationId: processFloorPlan
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                create_scene:
                  type: boolean
                  default: true
                run_compliance:
                  type: boolean
                  default: true
      responses:
        "202":
          description: –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—É—â–µ–Ω–∞
          content:
            application/json:
              schema:
                type: object
                properties:
                  task_id:
                    type: string
                    format: uuid
                  status:
                    type: string
                    example: processing

  # ---------------------------------------------------------------------------
  # Compliance Endpoints
  # ---------------------------------------------------------------------------
  /compliance/check:
    post:
      tags: [compliance]
      summary: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –Ω–æ—Ä–º–∞–º
      operationId: checkCompliance
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ComplianceCheckRequest"
      responses:
        "200":
          description: –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ComplianceCheckResponse"

  /compliance/rules:
    get:
      tags: [compliance]
      summary: –°–ø–∏—Å–æ–∫ –ø—Ä–∞–≤–∏–ª
      operationId: listComplianceRules
      security:
        - BearerAuth: []
      parameters:
        - name: category
          in: query
          schema:
            type: string
        - name: operation_type
          in: query
          schema:
            type: string
            enum: [construction, renovation, redevelopment]
      responses:
        "200":
          description: –°–ø–∏—Å–æ–∫ –ø—Ä–∞–≤–∏–ª
          content:
            application/json:
              schema:
                type: object
                properties:
                  rules:
                    type: array
                    items:
                      $ref: "#/components/schemas/ComplianceRule"
                  total_rules:
                    type: integer

  # ---------------------------------------------------------------------------
  # AI Endpoints
  # ---------------------------------------------------------------------------
  /ai/chat:
    post:
      tags: [ai]
      summary: –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ AI
      operationId: sendChatMessage
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ChatMessageRequest"
      responses:
        "200":
          description: –û—Ç–≤–µ—Ç AI
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ChatMessageResponse"
        "429":
          description: –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /ai/generate:
    post:
      tags: [ai]
      summary: –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã
      operationId: generateVariants
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/GenerateVariantsRequest"
      responses:
        "202":
          description: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–ø—É—â–µ–Ω–∞
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GenerateVariantsResponse"

  # ---------------------------------------------------------------------------
  # Request Endpoints
  # ---------------------------------------------------------------------------
  /requests:
    get:
      tags: [requests]
      summary: –°–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫
      operationId: listRequests
      security:
        - BearerAuth: []
      parameters:
        - name: workspace_id
          in: query
          schema:
            type: string
            format: uuid
        - name: status
          in: query
          schema:
            type: string
            enum:
              [
                draft,
                pending,
                in_review,
                approved,
                rejected,
                assigned,
                in_progress,
                completed,
                cancelled,
              ]
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: page_size
          in: query
          schema:
            type: integer
            default: 20
      responses:
        "200":
          description: –°–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫
          content:
            application/json:
              schema:
                type: object
                properties:
                  requests:
                    type: array
                    items:
                      $ref: "#/components/schemas/ExpertRequest"
                  pagination:
                    $ref: "#/components/schemas/Pagination"
    post:
      tags: [requests]
      summary: –°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É
      operationId: createRequest
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateExpertRequestRequest"
      responses:
        "201":
          description: –ó–∞—è–≤–∫–∞ —Å–æ–∑–¥–∞–Ω–∞
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExpertRequest"

  /requests/{id}/submit:
    post:
      tags: [requests]
      summary: –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É
      description: –ü–µ—Ä–µ–≤–æ–¥–∏—Ç –∑–∞—è–≤–∫—É –∏–∑ draft –≤ pending
      operationId: submitRequest
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: –ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExpertRequest"

  /requests/pricing:
    get:
      tags: [requests]
      summary: –¶–µ–Ω—ã –Ω–∞ —É—Å–ª—É–≥–∏
      operationId: getPricing
      responses:
        "200":
          description: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ü–µ–Ω–∞—Ö
          content:
            application/json:
              schema:
                type: object
                properties:
                  categories:
                    type: array
                    items:
                      type: object
                      properties:
                        code:
                          type: string
                        name:
                          type: string
                        description:
                          type: string
                        base_price:
                          type: integer
                        estimated_days:
                          type: string
                        includes:
                          type: array
                          items:
                            type: string
