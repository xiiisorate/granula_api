# Granula — Интеллектуальный сервис планирования ремонта

## 🎯 Проблема

Каждый, кто решает сделать ремонт с перепланировкой, сталкивается с двумя серьёзными проблемами:

### 1. Юридические риски
- **Не знаете, какие стены несущие** — их снос может привести к обрушению
- **Незаконная перепланировка** = штрафы до 350 000 ₽, предписание вернуть всё обратно
- **Невозможно продать квартиру** с неузаконенной перепланировкой
- **СНиПы и Жилищный кодекс** — сотни правил, которые невозможно изучить самостоятельно

### 2. Сложность визуализации
- **Эскизы от руки** — непонятно, как это будет выглядеть в реальности
- **3D-модели от дизайнеров** — дорого (от 30 000 ₽) и долго (2-4 недели)
- **Много идей** — но сравнить варианты невозможно без профессионала

---

## 💡 Решение

**Granula** — цифровой помощник, который позволяет:

1. ✅ **Загрузить план квартиры** (техпаспорт БТИ, скан, фото эскиза)
2. ✅ **Автоматически получить 3D-модель** с точными пропорциями
3. ✅ **Редактировать планировку** как в Sims — сносить стены, добавлять перегородки, расставлять мебель
4. ✅ **Видеть предупреждения в реальном времени** — система подскажет про несущие стены и нарушения норм
5. ✅ **Получить варианты от AI** — нейросеть предложит 3-5 вариантов планировки
6. ✅ **Заказать оформление документов** — когда вариант выбран, эксперт БТИ поможет узаконить

---

## 🖥️ Основной функционал

### 1. Распознавание планировки

```
Вход: Фото/скан техпаспорта БТИ, технический план или рукописный эскиз
Выход: Точная 3D-модель квартиры с определением:
       - Стен (несущие / ненесущие)
       - Комнат и их типов
       - Дверей и окон
       - Инженерных коммуникаций
```

**Как работает:**
- AI (Claude Vision) анализирует изображение
- Распознаёт элементы чертежа
- Определяет масштаб и размеры
- Создаёт структурированную 3D-модель

---

### 2. 3D-редактор (конструктор)

**Интерфейс:**
```
┌─────────────────────────────────────────────────────────────────┐
│  [Меню элементов]     [3D Сцена]              [Чат с AI]       │
│  ┌───────────────┐   ┌─────────────────────┐  ┌──────────────┐ │
│  │ 🧱 Стены      │   │                     │  │ 🤖 Привет!   │ │
│  │ 🚪 Двери      │   │    [3D модель       │  │ Чем помочь?  │ │
│  │ 🪟 Окна       │   │     квартиры]       │  │              │ │
│  │ 🛋️ Мебель     │   │                     │  │ [Ввод...]    │ │
│  │ 📦 Комнаты    │   │                     │  │              │ │
│  └───────────────┘   └─────────────────────┘  └──────────────┘ │
│  ┌─────────────────────────────────────────────────────────────┐│
│  │ [🔨 Снести] [➕ Добавить] [↔️ Переместить] [📐 Размеры]    ││
│  └─────────────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────────┘
```

**Возможности:**
- 🔨 **Снос стен** — удаление перегородок с проверкой на несущие
- ➕ **Добавление перегородок** — создание новых стен
- 🚪 **Проёмы** — добавление дверей, арок, окон
- 🛋️ **Мебель** — расстановка базовой мебели для оценки пространства
- 📐 **Объединение/разделение** — комнат

**Режимы просмотра:**
- 👁️ **Вид сверху (2.5D)** — классический план
- 🚶 **От первого лица** — прогулка по квартире

---

### 3. Проверка на соответствие нормам

**В реальном времени система проверяет:**

| Категория | Что проверяется | Пример |
|-----------|-----------------|--------|
| 🏗️ Конструкции | Несущие стены | "Эту стену сносить нельзя!" |
| 🚿 Сантехника | Мокрые зоны | "Санузел нельзя размещать над жилой комнатой" |
| 🔥 Пожарная безопасность | Эвакуация | "Ширина прохода должна быть минимум 0.8м" |
| 📏 Площади | Минимумы | "Площадь кухни менее 5м² — нарушение" |
| 💨 Вентиляция | Каналы | "Нельзя переносить вентканал" |
| ⚡ Газ | Газовые приборы | "Газовая плита и жилая комната — запрещено" |

**Уровни предупреждений:**
- 🔴 **Ошибка** — критическое нарушение, блокирует действие
- 🟡 **Предупреждение** — нежелательно, но допустимо
- 🔵 **Информация** — рекомендация

---

### 4. AI-генерация вариантов

**Как работает:**

```
Пользователь: "Хочу объединить кухню с гостиной, 
              сделать отдельную гардеробную"
              
AI генерирует: 3-5 вариантов планировки
              
┌─────────────────────────────────────────────────────────────┐
│  Вариант 1              Вариант 2              Вариант 3    │
│  ┌─────────────┐        ┌─────────────┐        ┌──────────┐ │
│  │ [Превью]    │        │ [Превью]    │        │ [Превью] │ │
│  │             │        │             │        │          │ │
│  └─────────────┘        └─────────────┘        └──────────┘ │
│  ✅ Соответствует       ✅ Соответствует       ⚠️ 1 warning │
│  "Полное объединение"   "С барной стойкой"    "С островом" │
│  [Выбрать]              [Выбрать]              [Выбрать]    │
└─────────────────────────────────────────────────────────────┘
```

**Система веток (branches):**
- Каждый вариант сохраняется как отдельная ветка
- Можно продолжить редактировать любой вариант
- История всех изменений сохраняется
- Можно сравнивать варианты между собой

---

### 5. Заявка на эксперта

**Когда пользователь выбрал вариант:**

```
┌─────────────────────────────────────────────────────────┐
│  📋 Оформить заявку на услуги БТИ                       │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  Тип услуги:                                           │
│  ○ Консультация (от 2 000 ₽)                          │
│  ● Оформление документации (от 15 000 ₽)              │
│  ○ Выезд эксперта (от 5 000 ₽)                        │
│  ○ Полный комплекс (от 30 000 ₽)                      │
│                                                         │
│  Контактные данные:                                    │
│  [Имя] [Телефон] [Email]                              │
│                                                         │
│  [Отправить заявку]                                    │
└─────────────────────────────────────────────────────────┘
```

**Workflow заявки:**
```
Создана → На рассмотрении → Одобрена → В работе → Выполнена
                ↓
           Отклонена (с причиной)
```

---

## 👥 Пользовательские сценарии

### Сценарий 1: Проверка идеи перепланировки

```
Мария хочет объединить кухню и гостиную.

1. Загружает фото техпаспорта
2. Система создаёт 3D-модель за 30 секунд
3. Пытается снести стену между кухней и гостиной
4. Система показывает: "✅ Стена ненесущая, можно сносить"
5. Но предупреждает: "⚠️ На кухне газовая плита — требуется 
   раздвижная перегородка или замена на электрическую"
6. Мария видит варианты решения и выбирает подходящий
```

### Сценарий 2: Поиск оптимальной планировки

```
Алексей купил квартиру и хочет переделать её под себя.

1. Загружает план квартиры
2. В чате пишет: "Нужна детская 12м², кабинет, 
   большая гостиная-кухня"
3. AI генерирует 5 вариантов
4. Алексей выбирает понравившийся
5. Дорабатывает его: двигает стены, расставляет мебель
6. Проверяет от первого лица — "гуляет" по квартире
7. Заказывает оформление документов
```

### Сценарий 3: Оценка законности существующей перепланировки

```
Семья Ивановых хочет продать квартиру, но 10 лет назад
сделали перепланировку без согласования.

1. Загружают текущий план
2. Система показывает нарушения:
   - ❌ Санузел расширен на жилую комнату
   - ❌ Снесена часть несущей стены
3. Понимают, что нужна консультация эксперта
4. Оставляют заявку
5. Эксперт помогает найти решение
```

---

## 🏗️ Архитектура системы (Микросервисы)

### Высокоуровневая схема

```
┌──────────────────────────────────────────────────────────────────┐
│                           КЛИЕНТЫ                                │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐            │
│  │   Web App    │  │  Mobile PWA  │  │    Expert    │            │
│  │   (Nuxt)     │  │   (Nuxt)     │  │    Portal    │            │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘            │
└─────────┼─────────────────┼─────────────────┼────────────────────┘
          └─────────────────┼─────────────────┘
                            │ HTTP/WebSocket
                            ▼
┌──────────────────────────────────────────────────────────────────┐
│                       API GATEWAY                                │
│             REST routing • JWT • Rate Limiting                   │
│                        Port: 8080                                │
└──────────────────────────────┬───────────────────────────────────┘
                               │ gRPC
        ┌──────────────────────┼──────────────────────┐
        │                      │                      │
        ▼                      ▼                      ▼
┌───────────────┐      ┌───────────────┐      ┌───────────────┐
│ Auth Service  │      │ User Service  │      │Workspace Svc  │
│    :50051     │      │    :50052     │      │    :50053     │
└───────┬───────┘      └───────┬───────┘      └───────┬───────┘
        │                      │                      │
        └──────────────────────┼──────────────────────┘
                               ▼
                    ┌─────────────────────┐
                    │     PostgreSQL      │
                    │   (users, auth,     │
                    │  workspaces, req)   │
                    └─────────────────────┘

┌───────────────┐      ┌───────────────┐      ┌───────────────┐
│Floor Plan Svc │─────►│  Scene Svc    │─────►│  Branch Svc   │
│    :50054     │      │    :50055     │      │    :50056     │
└───────┬───────┘      └───────┬───────┘      └───────┬───────┘
        │                      │                      │
        │                      └──────────────────────┘
        │                               ▼
        │                    ┌─────────────────────┐
        │                    │      MongoDB        │
        │                    │  (scenes, branches) │
        │                    └─────────────────────┘
        ▼
┌───────────────┐      ┌───────────────┐      ┌───────────────┐
│   AI Service  │─────►│Compliance Svc │      │ Request Svc   │
│    :50057     │      │    :50058     │      │    :50059     │
└───────┬───────┘      └───────────────┘      └───────┬───────┘
        │                                              │
        ▼                                              ▼
┌───────────────┐                            ┌───────────────┐
│  OpenRouter   │                            │Notification   │
│     API       │                            │   Service     │
└───────────────┘                            │    :50060     │
                                             └───────────────┘
                                                    │
        ┌───────────────────────────────────────────┘
        ▼
┌───────────────┐      ┌───────────────┐
│     Redis     │      │  MinIO / S3   │
│  Pub/Sub      │      │    Files      │
└───────────────┘      └───────────────┘
```

### 11 Микросервисов

| № | Сервис | Порт | Описание |
|---|--------|------|----------|
| 1 | **API Gateway** | 8080 | Единая точка входа, REST → gRPC |
| 2 | **Auth Service** | 50051 | Регистрация, логин, OAuth, JWT |
| 3 | **User Service** | 50052 | Профили, настройки, сессии |
| 4 | **Workspace Service** | 50053 | Проекты, участники, роли |
| 5 | **Floor Plan Service** | 50054 | Загрузка, распознавание |
| 6 | **Scene Service** | 50055 | 3D сцены, элементы |
| 7 | **Branch Service** | 50056 | Ветки, версионирование |
| 8 | **AI Service** | 50057 | Распознавание, генерация, чат |
| 9 | **Compliance Service** | 50058 | Проверка норм СНиП/ЖК |
| 10 | **Request Service** | 50059 | Заявки на экспертов |
| 11 | **Notification Service** | 50060 | Уведомления, email, push |

### Преимущества микросервисов

| Преимущество | Описание |
|--------------|----------|
| 🚀 **Масштабирование** | Каждый сервис масштабируется независимо |
| 👥 **Параллельная разработка** | 2 разработчика работают независимо |
| 🔧 **Изоляция отказов** | Падение одного сервиса не ломает всю систему |
| 📦 **Независимый деплой** | Обновление без остановки всей системы |
| 🔄 **Гибкость технологий** | Можно использовать разные БД для разных задач |

---

## 💰 Бизнес-модель

### Для БТИ (основной заказчик)

| Ценность | Описание |
|----------|----------|
| 🎯 **Лидогенерация** | Клиенты приходят на этапе планирования — самые "горячие" |
| 📈 **Конверсия** | Клиент уже доверяет, сам просит оформить документы |
| 💎 **Новый доход** | Подписки на premium-функции |
| 🏆 **Экспертность** | БТИ = центр компетенции, а не "контора по справкам" |

### Модель монетизации

```
┌─────────────────────────────────────────────────────────────┐
│                            FREE                             │
│  • 1 проект (воркспейс)                                     │
│  • Распознавание планировки                                 │
│  • Базовый редактор                                         │
│  • Проверка на критические нарушения                        │
└─────────────────────────────────────────────────────────────┘
                           ↓
┌─────────────────────────────────────────────────────────────┐
│                    PREMIUM (990 ₽/мес)                       │
│  • Неограниченное количество проектов                       │
│  • AI-генерация вариантов                                   │
│  • Полная проверка compliance                               │
│  • Экспорт в PDF/DWG                                        │
│  • Приоритетная поддержка                                   │
└─────────────────────────────────────────────────────────────┘
                           ↓
┌─────────────────────────────────────────────────────────────┐
│                    УСЛУГИ БТИ (разово)                       │
│  • Консультация — от 2 000 ₽                                │
│  • Оформление документов — от 15 000 ₽                      │
│  • Выезд эксперта — от 5 000 ₽                              │
│  • Полный комплекс — от 30 000 ₽                            │
└─────────────────────────────────────────────────────────────┘
```

---

## 📊 Метрики успеха

### Продуктовые метрики

| Метрика | Цель (MVP) | Цель (6 мес) |
|---------|------------|--------------|
| Регистрации | 1 000 | 50 000 |
| Активные пользователи (MAU) | 300 | 15 000 |
| Распознанных планировок | 500 | 25 000 |
| Сгенерированных вариантов | 2 000 | 100 000 |
| Заявок на экспертов | 50 | 2 500 |

### Технические метрики

| Метрика | Цель |
|---------|------|
| Uptime | 99.9% |
| Время распознавания | < 60 сек |
| Время генерации вариантов | < 30 сек |
| API latency (p99) | < 500 мс |

---

## 🗓️ Roadmap

### MVP (48 часов — хакатон)

- [x] Аутентификация (email + OAuth)
- [x] Создание воркспейсов
- [x] Загрузка планировок
- [x] AI распознавание (базовое)
- [x] 3D редактор (базовый)
- [x] Проверка несущих стен
- [x] Чат с AI
- [x] Генерация вариантов
- [x] Заявки на экспертов

### v1.0 (1 месяц после хакатона)

- [ ] Полное compliance (СНиП, ЖК РФ)
- [ ] Расширенная библиотека мебели
- [ ] Экспорт в PDF
- [ ] Email уведомления
- [ ] Мобильная версия (PWA)

### v2.0 (3 месяца)

- [ ] Collaborative editing (совместная работа)
- [ ] Экспорт в DWG (AutoCAD)
- [ ] Интеграция с маркетплейсами мебели
- [ ] Расчёт стоимости ремонта
- [ ] AR-просмотр (дополненная реальность)

### v3.0 (6 месяцев)

- [ ] Белый лейбл для риелторских агентств
- [ ] API для партнёров
- [ ] AI-помощник по подбору материалов
- [ ] Интеграция с сервисами ремонта

---

## 🏆 Конкурентные преимущества

| Мы | Конкуренты |
|----|------------|
| AI распознавание за 30 сек | Ручная отрисовка 2-3 часа |
| Проверка норм в реальном времени | Проверка только у эксперта |
| Генерация вариантов AI | Только 1 вариант от дизайнера |
| От идеи до документов в одном месте | Разные сервисы, разные подрядчики |
| Бесплатно начать | Платно с первого шага |

---

## 👨‍💻 Команда и роли

### Для хакатона

| Роль | Задачи |
|------|--------|
| **Backend** | API, базы данных, интеграции |
| **Frontend** | 3D редактор, UI/UX |
| **AI/ML** | Промпты, распознавание, генерация |
| **Product** | Требования, тестирование, презентация |

---

## 📞 Контакты

- **Проект**: Granula
- **Репозиторий**: github.com/granula
- **Документация**: docs.granula.ru

---

*Granula — делаем ремонт безопасным и понятным* 🏠

